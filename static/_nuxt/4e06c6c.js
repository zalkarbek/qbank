(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{580:function(t,e,n){"use strict";n.r(e);n(29),n(30);var r=n(6),c={data:function(){return{ads:{file:{},department:"",duration:null},adsLists:[]}},mounted:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getAds();case 2:case"end":return e.stop()}}),e)})))()},methods:{selectFile:function(t){var e=t.target.files;this.ads.file=e[0]},getAds:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.$api.getApi("adsApi"),e.next=3,n.getAds();case 3:t.adsLists=e.sent;case 4:case"end":return e.stop()}}),e)})))()},uploadFile:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ads||!t.ads.file||t.ads.file.name){e.next=4;break}return e.next=3,t.$store.dispatch("toast/toastDanger",{message:"Пожалуйста виберите файл"});case 3:return e.abrupt("return");case 4:return(n=new FormData).append("fileName",t.ads.file.name),n.append("file",t.ads.file),n.append("duration",t.ads.duration),r=t.$api.getApi("adsApi"),e.prev=9,t.$nuxt.$loading.start(),e.next=13,r.uploadFile(n);case 13:if(!e.sent){e.next=20;break}return e.next=17,t.$store.dispatch("toast/toastSuccess",{message:"Медиа контент успешно загружен"});case 17:return t.toClearForm(),e.next=20,t.getAds();case 20:e.next=26;break;case 22:return e.prev=22,e.t0=e.catch(9),e.next=26,t.$store.dispatch("toast/toastDanger",{message:"Не удалось загрузить медиа"});case 26:t.$nuxt.$loading.finish();case 27:case"end":return e.stop()}}),e,null,[[9,22]])})))()},deleteAds:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=e.$api.getApi("adsApi"),n.next=3,e.$store.dispatch("modal/confirmDelete");case 3:if(!n.sent){n.next=19;break}return n.next=7,r.deleteAdsById(t.id);case 7:if(!(c=n.sent)||!c.success){n.next=15;break}return n.next=11,e.$store.dispatch("toast/toastSuccess",{message:"Медиа контент успешно удален"});case 11:return n.next=13,e.getAds();case 13:n.next=19;break;case 15:return n.next=17,e.$store.dispatch("toast/toastDanger",{message:"Невозможно удалить медиа контент возможно файл воспроизводится телевизором"});case 17:return n.next=19,e.getAds();case 19:case"end":return n.stop()}}),n)})))()},toClearForm:function(){this.ads={file:{},department:"",duration:null}}}},d=n(39),component=Object(d.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-fluid"},[n("div",{staticClass:"row row-xs"},[t._m(0),t._v(" "),n("div",{staticClass:"col-md-12"},[n("div",{staticClass:"card"},[n("div",{staticClass:"card-header bd-b-0 pd-t-20 pd-lg-t-25 pd-l-20 pd-lg-l-25"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-3 mb-2"},[n("div",{staticClass:"mb-3 custom-file"},[n("label",{staticClass:"form-label custom-file-label",attrs:{for:"formFile"}},[t._v("Выберите файл")]),t._v(" "),n("input",{staticClass:"form-control custom-file-input",staticStyle:{width:"300px","overflow-x":"hidden"},attrs:{id:"formFile",type:"file"},on:{change:t.selectFile}})]),t._v(" "),n("div",[n("i",{staticClass:"fad fa-file"}),t._v(" "),n("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.ads&&t.ads.file&&t.ads.file.name||""))])])]),t._v(" "),n("div",{staticClass:"col-md-2 mb-4"},[n("b-form-group",{staticClass:"mb-0",attrs:{description:"Продолжительность показа в минутах только для картинок"}},[n("b-form-input",{attrs:{placeholder:"Минуты"},model:{value:t.ads.duration,callback:function(e){t.$set(t.ads,"duration",e)},expression:"ads.duration"}})],1)],1),t._v(" "),n("div",{staticClass:"col-md-4"},[n("div",{staticClass:"btn-group mg-t-20 mg-sm-t-0"},[n("button",{staticClass:"btn btn-white btn-uppercase",on:{click:t.uploadFile}},[n("i",{staticClass:"fad fa-cloud-upload"}),t._v("\n                  Загрузить\n                ")])])])])]),t._v(" "),n("div",{staticClass:"card-body pd-lg-25"},[n("table",{staticClass:"table table-bordered table-sm"},[t._m(1),t._v(" "),n("tbody",[t._l(t.adsLists,(function(e,r){return[n("tr",{key:e.id},[n("td",[t._v(t._s(r+1))]),t._v(" "),n("td",[t._v(t._s(e.type))]),t._v(" "),n("td",[t._v(t._s(e.name))]),t._v(" "),n("td",[t._v(t._s(e.duration))]),t._v(" "),n("td",[n("button",{staticClass:"btn btn-xs btn-outline-danger",attrs:{type:"button"},on:{click:function(n){return t.deleteAds(e)}}},[n("i",{staticClass:"fad fa-trash"})])])])]}))],2)])])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-sm-flex align-items-center justify-content-between col-md-12 mg-b-20 mg-lg-b-25 mg-xl-b-30"},[e("div",[e("h4",{staticClass:"mg-b-0 tx-spacing--1"},[this._v("\n          Загрузка видео, фото контента\n        ")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",{staticClass:"font-weight-bold"},[n("tr",[n("td",[t._v("\n                  №\n                ")]),t._v(" "),n("td",[t._v("\n                  Тип файла\n                ")]),t._v(" "),n("td",[t._v("\n                  Имя файла\n                ")]),t._v(" "),n("td",[t._v("\n                  Длительность показа мин.\n                ")]),t._v(" "),n("td",[t._v("\n                  #\n                ")])])])}],!1,null,null,null);e.default=component.exports}}]);